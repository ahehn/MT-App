<!DOCTYPE HTML>
<title>Hochschule Karlsruhe - Mechatronik</title>
<html>
	<!-- ######################### HEAD ######################### -->
	<head>
	
	
		<meta name="Content-Type" content="text/html"; charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		
		<!-- Einbindung von Phonegap und Plugin -->
		<script src="phonegap.js"></script>
		<script src="barcodescanner.js"></script>
		
		<!-- Einbindung der Stylesheets -->
		<link rel="stylesheet" type="text/css" href="../styles/jquery.mobile.structure-1.3.2.min.css" />
		<link rel="stylesheet" type="text/css" href="../styles/themes/20130731_MT_Theme.min.css" />
		
		<!-- Eigene CSS allgemein für alle Subtopics -->
		<!-- <link rel="stylesheet" href="../styles/main_topics_styles.css"  type="text/css" /> -->
		
		<!-- Eigene CSS für die Navigation -->
		<link rel="stylesheet" href="../styles/navigation.css"  type="text/css" />
		
		<!-- Eigene CSS für die Toolbar -->
		<!-- <link rel="stylesheet" href="../styles/toolbar.css" type="text/css" /> -->
		
		<!-- Eigene JavaScript für ??? -->				
		<!-- <script type="text/javascript" src="../js/showHideLayer.js"></script> -->
		
		<!-- GoogleMaps API -->
		<script src="http://maps.google.com/maps/api/js?sensor=true" type="text/javascript"></script>
		
		<!-- Einbindung von jQuery und jQuery mobile -->
		<script type="text/javascript" src="../js/jquery-2.0.3.min.js"></script>
		<script type="text/javascript" src="../js/jquery.mobile-1.3.2.min.js"></script>
		
		<!-- jQuery mobile GOOGLE MAPS Plugin -->		
		<script src="../js/jquery.ui.map.full.min.js" type="text/javascript"></script>
		
				<!-- Eigene Java-Script Funktionen -->	
		<script type="text/javascript">
		// jQuery
 			 $(function(){	
			 			 
			 // Erfassen der aktuellen Position und setzen eines Markes
			   navigator.geolocation.getCurrentPosition(function(position){
			   meineLongitude = position.coords.longitude;
			   meineLatitude = position.coords.latitude;			   
			   var Latlng_position = new google.maps.LatLng(meineLatitude, meineLongitude); // Schreibt aktuelle Position in Koordinaten-Variable für die aktuellen Position
			   var mapOptions = {													// Definition der Anzeige-Optionen der Google-Maps karte
					zoom: 17,													// Zoom-Stufe der Karte
					center: Latlng_position,										// Definition des Mittelspunktes nach dem die Karte ausgerichtet wird
					panControl: false,											// panControl-Button wird deaktiviert
					zoomControl: true,											// ZoomControl-Button wird aktiviert
					mapTypeControl: false,										// Auswahlmöglichkeit für Kartentyp wird deaktiviert
					scaleControl: true,											// scaleControl wird aktiviert
					streetViewControl: false,									// StreetViewControl-Button wird deaktiviert
					mapTypeId: google.maps.MapTypeId.ROADMAP					// Definiert den Anzeige-Typ der Goole Maps Karte
			   };
			   
			   // Google Map erzeugen
			   var map = new google.maps.Map(document.getElementById('karte'), mapOptions);
			   // Marker für aktuellen Standort einfügen
			   var marker = new google.maps.Marker({
				position: Latlng_position,
				map: map,
				title: 'Mein Standort',
				icon: '../bilder/position.png'
			   });
			   
			   // Auslesen der JSON-Datei und zeichnen von Google-Maps-Markern
				$.getJSON('../daten/gebaeude.json', function(json) {
					$.each(json, function(bau,data) {
						var latLng = new google.maps.LatLng(data.position.latitude, data.position.longitude); 
						// Creating a marker and putting it on the map
						var marker = new google.maps.Marker({
							position: latLng,
							map: map,
							title: data.name,
							icon: '../bilder/' + bau + '.png'
						});
					});
				});
			   },
			   // Ausgabe einer Fehlermeldung sowie änderung der Anzeige-Optionen, wenn die Koordinaten der aktuellen Position nicht bestimmt werden konnten
			   function(){window.alert('Deine Position konnte nicht ermittelt werden! :-(');
			   var Latlng_center = new google.maps.LatLng(49.013625,8.390161);	// Erstellt Variable mit der Position nach der die Karte zentriert werden soll
			   var mapOptions = {													// Definition der Anzeige-Optionen der Google-Maps karte
					zoom: 15,													// Zoom-Stufe der Karte
					center: Latlng_center,										// Definition des Mittelspunktes nach dem die Karte ausgerichtet wird
					panControl: false,											// panControl-Button wird deaktiviert
					zoomControl: true,											// ZoomControl-Button wird aktiviert
					mapTypeControl: false,										// Auswahlmöglichkeit für Kartentyp wird deaktiviert
					scaleControl: true,											// scaleControl wird aktiviert
					streetViewControl: false,									// StreetViewControl-Button wird deaktiviert
					mapTypeId: google.maps.MapTypeId.ROADMAP					// Definiert den Anzeige-Typ der Goole Maps Karte
			 };
			 // Google Map erzeugen
			 var map = new google.maps.Map(document.getElementById('karte'), mapOptions);
			 
			 // Auslesen der JSON-Datei und zeichnen von Google-Maps-Markern
				$.getJSON('../daten/gebaeude.json', function(json) {
					$.each(json, function(bau,data) {
						var latLng = new google.maps.LatLng(data.position.latitude, data.position.longitude); 
						// Creating a marker and putting it on the map
						var marker = new google.maps.Marker({
							position: latLng,
							map: map,
							title: data.name,
							icon: '../bilder/' + bau + '.png'
						});
					});
				});
			  }
			 );
			  	
			});
			
			
			// Start des Barcode-Scanner Plugins durch Klick auf SCAN-Button
			$( "#scan" ).click(function() {
			var scanner = cordova.require("cordova/plugin/BarcodeScanner");
		    scanner.scan(
			  function (result) {
				  alert("We got a barcode\n" +
						"Result: " + result.text + "\n" +
						"Format: " + result.format + "\n" +
						"Cancelled: " + result.cancelled);
			  }, 
			  function (error) {
				  alert("Scanning failed: " + error);
			  }
		    );
			});
			
			
		</script>	
		
	</head>

	<!-- ######################### BODY ######################### -->
	<body>
		<div data-role="page"  id="p1"  data-theme="a">
			<!-- ######################### HEADER ######################### -->
			<div data-role="header" data-position="fixed">
				<a href="../index.html" class="ui-icon-alt" data-role="button" data-icon="back" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
				<h1>Navigator</h1>
				<a href="../main.html" class="ui-icon-alt" data-role="button" data-icon="bars" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
			</div>
			
			<!-- ######################### Content ######################### -->
			<div data-role="content" class="content">
				<div id="karte" style="position:absolute; width: 100%;height: 100%"> <!-- hier wird die Karte angezeigt --></div>
			</div>
			
			<!-- ######################### FOOTER ######################### -->
			<div data-role="footer" data-position="fixed">
				<div data-role="navbar">
					<ul>
						<li><a href="#p1" data-icon="arrow-u" data-iconpos="top" data-transition="none" class="ui-btn-active ui-state-persist">Karte</a></li>
						<li><a href="#p2" data-icon="arrow-u" data-iconpos="top" data-transition="none">QR-Code</a></li>
						<li><a href="#p3" data-icon="arrow-u" data-iconpos="top" data-transition="none">Gebäudeplan</a></li>
					</ul>
				</div><!-- /navbar -->
			</div><!-- /footer -->
		</div>
		
		
		<div data-role="page"   id="p2" data-theme="a">
			<!-- ######################### HEADER ######################### -->
			<div data-role="header" data-position="fixed">
				<a href="../index.html" class="ui-icon-alt" data-role="button" data-icon="back" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
				<h1>Navigator</h1>
				<a href="../main.html" class="ui-icon-alt" data-role="button" data-icon="bars" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
			</div>
			
			<!-- ######################### Content ######################### -->
			<div data-role="content" class="content">
				<p>Du weißt nicht wo du gerade bist? Dann scanne einen QR-Code in deiner Nähe. Er wird die weiterhelfen...</p>
				
				<p><button id="scan" data-icon="search" data-iconpos="top">SCAN</button> </p>
				
	
			</div>
			
			<!-- ######################### FOOTER ######################### -->
			<div data-role="footer" data-position="fixed">
				<div data-role="navbar">
					<ul>
						<li><a href="#p1" data-icon="arrow-u" data-iconpos="top" data-transition="none">Karte</a></li>
						<li><a href="#p2" data-icon="arrow-u" data-iconpos="top" data-transition="none" class="ui-btn-active ui-state-persist">QR-Code</a></li>
						<li><a href="#p3" data-icon="arrow-u" data-iconpos="top" data-transition="none">Gebäudeplan</a></li>
					</ul>
				</div><!-- /navbar -->
			</div><!-- /footer -->
		</div>
		
		
		<div data-role="page" id="p3"  data-theme="a">
			<!-- ######################### HEADER ######################### -->
			<div data-role="header" data-position="fixed">
				<a href="../index.html" class="ui-icon-alt" data-role="button" data-icon="back" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
				<h1>Navigator</h1>
				<a href="../main.html" class="ui-icon-alt" data-role="button" data-icon="bars" data-iconpos="notext" data-inline="true">Home - Black icons, no disc</a>
			</div>
			
			<!-- ######################### Content ######################### -->
			<div data-role="content">
				<p>Hier kommt eine Gebäudeplan hin</p>
			</div>
			
			<!-- ######################### FOOTER ######################### -->
			<div data-role="footer" data-position="fixed">
				<div data-role="navbar">
					<ul>
						<li><a href="#p1" data-icon="arrow-u" data-iconpos="top" data-transition="none">Karte</a></li>
						<li><a href="#p2" data-icon="arrow-u" data-iconpos="top" data-transition="none">QR-Code</a></li>
						<li><a href="#p3" data-icon="arrow-u" data-iconpos="top" data-transition="none" class="ui-btn-active ui-state-persist">Gebäudeplan</a></li>
					</ul>
				</div><!-- /navbar -->
			</div><!-- /footer -->
		</div>
		
		
		
	
	
		
	</body>
</html>

